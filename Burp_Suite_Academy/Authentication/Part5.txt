Vulnerabilities in multi-factor authentication:


While it is sometimes possible for an attacker to obtain a single knowledge-based factor, such as a password, being able to simultaneously obtain another factor from an out-of-band source is considerably less likely. For this reason, two-factor authentication is demonstrably more secure than single-factor authentication. However, as with any security measure, it is only ever as secure as its implementation. Poorly implemented two-factor authentication can be beaten, or even bypassed entirely, just as single-factor authentication can.

It is also worth noting that the full benefits of multi-factor authentication are only achieved by verifying multiple different factors. Verifying the same factor in two different ways is not true two-factor authentication. Email-based 2FA is one such example. Although the user has to provide a password and a verification code, accessing the code only relies on them knowing the login credentials for their email account. Therefore, the knowledge authentication factor is simply being verified twice.

--------------------------
--------------------------

Two-factor authentication tokens:

Verification codes are usually read by the user from a physical device. Many high-security websites now provide users with a dedicated device for this purpose, such as the RSA token or a keypad device. In addition to being purpose-built for security, these dedicated devices also have the advantage of generating the verification code directly. It is also common for websites to use a dedicated mobile app, such as Google Authenticator, for the same reason.

On the hand, some websites send verification codes to a user's mobile phone as a text message. While this is technically still verifying the factor of something the user has, it is prone to abuse. Firstly, the code is being transmitted via SMS rather than being generated by the device itself. This creates the potential for the code to be intercepted. There is also a risk of SIM swapping, where an attacker fraudulently obtains a SIM car with the victim's phone number. The attacker would receive all SMS messages sent to the victim, including the one containing their verification code.

--------------------------
--------------------------

Bypassing two-factor authentication:

If the user is first prompt to enter a password, and then prompted to enter a verification code on a separate page, the user is in a logged in state before even entering the verification code. In this  case, it is worth testing if we can directly skip to logged-in only pages after completing the first authentication step. Occasionally, we will find that a website doesn't actually check whether or not you completed the second step before loading the page.

--------------------------
--------------------------
Lab: 2FA simple bypass

This lab's two-factor authentication can be bypassed. You have already obtained a valid username and password, but do not have access to the user's 2FA verification code. To solve the lab, access Carlos's account page.

Your credentials: wiener:peter
Victim's credentials carlos:montoya

We will login using the user wiener credentials. After that we will prompt to enter the code that we were sent to our email. If we clicked on the Email user tab in the website, we will see that we got a code. If we entered that code, we will be logged in as wiener. 

However, after we are logged in, we will notice the end of the URL:/my-account?id=wiener. We can try to replace the username of wiener with carlos after we are prompt to enter the 2F auth code for carlos.

We will login using carlos credentials. We will again be prompt to enter the 2F code. However, if we put this : /my-account?id=carlos instead of /login2, we will be logged in as carlos.

 



